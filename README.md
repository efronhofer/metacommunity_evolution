# The conflict between adaptation and dispersal for maintaining biodiversity in changing environments

Code for:

Patrick L. Thompson and Emanuel A. Fronhofer: The conflict between adaptation and dispersal for maintaining biodiversity in changing environments

Abstract: 

Dispersal and adaptation represent two ways that allow species to persist in changing environments. Yet, we lack an understanding of how these processes interact to affect species persistence, especially in communities where biotic interactions greatly complicate responses to environmental change. Here we use a stochastic metacommunity model to show that dispersal and adaptation to environmental change have conflicting contributions to biodiversity maintenance. We find that both dispersal and adaptation to environmental change independently contribute to the maintenance of biodiversity. But, when species both adapt and disperse, faster adapting species evolve to hold onto their initial ranges, thus impeding slower adapting species from shifting their ranges and causing extinctions. Importantly, these differences in adaptation speed emerge as the result of competition, which alters population sizes and colonization success. Thus, the maintenance of biodiversity in changing environments depends jointly on rates of dispersal and adaptation, and critically, the interaction between these processes. 

Preprint available on bioRxiv: https://doi.org/10.1101/490722

NOTE: This code was corrected due a misplaced bracket in the dispersal procedure. The bug was discovered by Peter Kamal who has rerun simulations and could show that our results and conclusions do not change. We have contacted PNAS about this error and a correction will be published. Even if results do not change we do not encourage the use of the old code.
